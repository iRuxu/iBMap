var iBMap={version:"1.0",github:"git@github.com:iRuxu/iBMap.git",BMap:{},ak:"",_lat:0,_lng:0,_zoom:5,_title:"",_content:"",_status:!1,_width:0,_height:0,_icon:{},geo:{lat:35.16277754545299,lng:112.81271748030389,zoom:16,title:"我的位置",content:"目的地",status:!1,width:290,height:"",icon:{url:"",width:0,height:0}},init:function(a,t){return iBMap.ak=a,iBMap.BMap=new BMap.Map(t),iBMap.BMap.addControl(new BMap.NavigationControl),iBMap.BMap.enableScrollWheelZoom(),iBMap},geocode:function(a,t){a||console.error("[iBMap]正地理编码失败，请输入有效的字符串地址"),$.ajax({url:"http://api.map.baidu.com/geocoder/v2/",type:"get",dataType:"jsonp",data:{ak:iBMap.ak,address:a,output:"json"},success:function(a){var i={};i.lat=a.result.location.lat,i.lng=a.result.location.lng,console.log("[iBMap]正地理编码结果",i),!!t&&t(i)},error:function(){console.error("[iBMap]无法连接百度地图正/逆地理编码接口")}})},position:function(a){iBMap._lng=a.lng||iBMap.geo.lng,iBMap._lat=a.lat||iBMap.geo.lat,iBMap._zoom=a.zoom||iBMap.geo.zoom;var t=new BMap.Point(a.lng,a.lat);return iBMap.BMap.centerAndZoom(t,a.zoom),iBMap},cn:function(){var a=new BMap.Point(iBMap.geo.lng,iBMap.geo.lat);return iBMap.BMap.centerAndZoom(a,5),iBMap},marker:function(a,t){function i(a){p.addEventListener("click",function(i){n(),!!t&&t(a)})}function n(){var a=new BMapLib.SearchInfoWindow(iBMap.BMap,iBMap._content,{title:iBMap._title,width:iBMap._width,height:iBMap._height,panel:"panel",enableAutoPan:!0,searchTypes:[BMAPLIB_TAB_SEARCH,BMAPLIB_TAB_TO_HERE,BMAPLIB_TAB_FROM_HERE]});a.open(e,iBMap._zoom)}a.lng&&a.lat||console.error("[iBMap]添加标记失败,传入的地理信息对象有误"),iBMap._lng=a.lng,iBMap._lat=a.lat,iBMap._zoom=a.zoom||iBMap.geo.zoom,iBMap._title=a.title||"",iBMap._content=a.content||"",iBMap._width=a.width||iBMap.geo.width,iBMap._height=a.height||iBMap.geo.height;var e=new BMap.Point(a.lng,a.lat);if(iBMap.BMap.centerAndZoom(e,iBMap._zoom),a.icon)var o=new BMap.Icon(a.icon.url,new BMap.Size(a.icon.width,a.icon.height)),p=new BMap.Marker(e,{icon:o});else var p=new BMap.Marker(e);return iBMap.BMap.addOverlay(p),i(a),!!a.status&&n(),iBMap},markers:function(a,t){function i(a){p.addEventListener("click",function(i){n(a),!!t&&t(a)})}function n(a){var t=a.content||iBMap._content,i=a.title||iBMap._title,n=a.width||iBMap._width,e=a.height||iBMap._height,o=new BMap.Point(a.lng,a.lat),p=new BMapLib.SearchInfoWindow(iBMap.BMap,t,{title:i,width:n,height:e,panel:"panel",enableAutoPan:!0,searchTypes:[BMAPLIB_TAB_SEARCH,BMAPLIB_TAB_TO_HERE,BMAPLIB_TAB_FROM_HERE]});p.open(o,iBMap._zoom)}a.data&&Array.isArray(a.data)||console.error("[iBMap]传入的标记数据有误"),iBMap._lng=a.center.lng||iBMap.geo.lng,iBMap._lat=a.center.lat||iBMap.geo.lat,iBMap._zoom=a.zoom||iBMap.geo.zoom,iBMap._width=a.width||iBMap.geo.width,iBMap._height=a.height||iBMap.geo.height,iBMap._title=a.title||iBMap.geo.title,iBMap._content=a.content||iBMap.geo.content,iBMap.BMap.centerAndZoom(new BMap.Point(a.center.lng,a.center.lat),iBMap._zoom);for(var e=0;e<a.data.length;e++){if(a.data[e].icon)var o=new BMap.Icon(a.data[e].icon.url,new BMap.Size(a.data[e].icon.width,a.data[e].icon.height)),p=new BMap.Marker(new BMap.Point(a.data[e].lng,a.data[e].lat),{icon:o});else var p=new BMap.Marker(new BMap.Point(a.data[e].lng,a.data[e].lat));iBMap.BMap.addOverlay(p),i(a.data[e]),!!a.data[e].status&&n(a.data[e])}return iBMap},URI:{marker:function(a,t){var i="http://api.map.baidu.com/marker?location="+t.lat+","+t.lng+"&title="+t.title+"&content="+t.content+"&output=html";document.getElementById(a).src=i}}};